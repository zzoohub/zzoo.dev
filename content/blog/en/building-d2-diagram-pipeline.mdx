---
title: "Building a D2 Diagram Pipeline for Documentation"
description: "Stop dragging boxes around. Learn how to treat your architecture diagrams as code, version control them, and render them automatically in CI."
date: "2026-01-12"
tags: ["DevOps", "D2"]
locale: "en"
draft: false
---

Architecture diagrams are essential for documentation, but maintaining them with visual tools like draw.io or Figma creates friction. What if you could write your diagrams as code and render them automatically?

## Why D2?

D2 is a modern diagramming language that's declarative, version-controllable, and produces clean SVGs. Unlike Mermaid, it supports advanced layouts, themes, and has a dedicated CLI.

```d2
client -> api: REST
api -> database: SQL
api -> cache: Redis
```

## The Build Pipeline

The key insight is treating diagrams like any other build artifact:

1. Write `.d2` source files alongside your content
2. A build script compiles them to SVG at build time
3. Light and dark theme variants are generated automatically
4. SVGs are committed to `public/` for serving

## Theme Support

Each diagram gets compiled twice â€” once for light mode and once for dark. The component conditionally shows the right version based on the current theme.

## Integration with CI

The build script runs as a pre-build step in CI. If a `.d2` file changes, the corresponding SVGs are regenerated. This keeps diagrams always up-to-date with the code.

This approach has saved me hours of manual diagram updates and ensures my architecture documentation never goes stale.
